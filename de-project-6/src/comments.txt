# Комментарий 2 

aws у меня - это название соединения, и оно работает (иначе бы не скачивались файлы). 
Когда передаю dest_file_path =  '/data/dialogs_20230529.csv', получаю ошибку:
NotADirectoryError: [Errno 20] Not a directory: '/data/dialogs_20230529.csv/airflow_tmp_h139dfsp'. 
К этому и был вопрос.

В любом случае, спасибо, потом разберусь с этим соединением.)

Привет! 

При первой попытке отправлял вопрос в README (видимо ты его не увидел), дублирую сюда в конец. 
Специально оставленный закоменченый код переношу сюда. Остальные замечания принял, спасибо. 

    # source_s3_key = f'{key}.csv'
    # source_s3_bucket = bucket
    # dest_file_path = dest_dir

    # source_s3 = S3Hook('aws')
    # source_s3.download_file(source_s3_key, bucket_name=source_s3_bucket, local_path = dest_file_path) 



# Вопрос

Привет!

Помоги, пожалуйста, разобораться с работой S3Hook. Код закомменчен в load_dag.py.

Почему-то он сохраняет в local_path (если указать, например, '/data/') файл с названием типа airflow_tmp_h139dfsp. При этом аргументы preserve_file_name и use_autogenerated_subdir не принимает вообще. 
А если указать директорию с названием файла, то пытается записать поверх и выдает ошибку 
NotADirectoryError: [Errno 20] Not a directory: '/data/dialogs_20230529.csv/airflow_tmp_h139dfsp'.

В UI такое соединение:
Connection Type: Amazon Web Services, 
Extra: {"aws_access_key_id": "YCAJEWXOyY8Bmyk2eJL-hlt2K", "aws_secret_access_key": "YCPs52ajb2jNXxOUsL4-pFDL1HnV2BCPd928_ZoA", "endpoint_url": "https://storage.yandexcloud.net"}.



    
  